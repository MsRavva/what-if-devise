# Руководство по устранению неполадок

## Распространенные проблемы и их решения

### 1. Ошибка "Hugging Face API ключ не настроен"

**Проблема:** Приложение показывает сообщение "Hugging Face API ключ не настроен" или "Неверный Hugging Face API ключ".

**Решение:**
1. Убедитесь, что у вас есть файл `.env.local` в корне проекта
2. Проверьте, что файл содержит строку:
   ```
   HUGGING_FACE_API_KEY=hf_your_actual_api_key_here
   ```
3. Убедитесь, что ваш API ключ начинается с префикса `hf_`
4. Перезапустите сервер разработки после изменения файла

### 2. Ошибка "No Inference Provider available for model"

**Проблема:** Приложение показывает сообщение "Не удалось сгенерировать сценарий" и в логах сервера видны ошибки "No Inference Provider available for model".

**Причины и решения:**
1. **Модель недоступна для вашего аккаунта:**
   - Перейдите на страницу модели на Hugging Face (например, https://huggingface.co/google/flan-t5-large)
   - Нажмите кнопку "Use this model"
   - Подтвердите использование модели в своих проектах

2. **Проблемы с квотами:**
   - Бесплатные аккаунты Hugging Face имеют ограничения на использование моделей
   - Попробуйте обновить аккаунт до Pro на https://huggingface.co/pricing

3. **Проблемы с регионом:**
   - Некоторые модели могут быть недоступны в вашем регионе
   - Попробуйте использовать другие модели из списка

### 3. Ошибка "Не удалось сгенерировать сценарий с использованием AI"

**Проблема:** Приложение показывает сообщение "Не удалось сгенерировать сценарий с использованием AI".

**Возможные причины и решения:**
1. **Неверный API ключ:**
   - Проверьте правильность API ключа в файле `.env.local`
   - Убедитесь, что ключ не истек и имеет роль 'Read'

2. **Проблемы с подключением к интернету:**
   - Проверьте подключение к интернету
   - Убедитесь, что брандмауэр не блокирует соединение

3. **Проблемы с доступом к моделям Hugging Face:**
   - Некоторые модели могут быть временно недоступны
   - Приложение автоматически пробует другие модели

### 4. Сервер не запускается или не отвечает

**Проблема:** Приложение не открывается по адресу http://localhost:3000

**Решения:**
1. **Проверьте, запущен ли сервер:**
   - Убедитесь, что команда `pnpm dev` выполняется без ошибок
   - Проверьте, что в терминале отображается сообщение "Ready in X.Xs"

2. **Проверьте порт:**
   - По умолчанию приложение использует порт 3000
   - Если порт занят, Next.js может автоматически выбрать другой порт
   - Обратите внимание на сообщение в терминале о фактическом порте

3. **Перезапустите сервер:**
   - Остановите сервер (Ctrl+C)
   - Запустите снова командой `pnpm dev`

### 5. Ошибки при установке зависимостей

**Проблема:** Ошибки при выполнении `pnpm install`

**Решения:**
1. **Очистите кэш:**
   ```bash
   pnpm store prune
   ```

2. **Удалите node_modules и переустановите:**
   ```bash
   rm -rf node_modules
   rm pnpm-lock.yaml
   pnpm install
   ```

3. **Проверьте версию Node.js:**
   - Убедитесь, что используете Node.js версии 18 или выше
   - Проверьте версию командой `node --version`

### 6. Ошибки TypeScript

**Проблема:** Ошибки типов при запуске или сборке

**Решения:**
1. **Проверьте типы:**
   ```bash
   pnpm run type-check
   ```

2. **Обновите зависимости:**
   ```bash
   pnpm update
   ```

### 7. Проблемы с генерацией сценариев

**Проблема:** Генерируются пустые или некорректные сценарии

**Решения:**
1. **Уточните вопрос:**
   - Используйте более конкретные формулировки
   - Добавьте детали в исходную историю

2. **Попробуйте перегенерировать:**
   - Нажмите кнопку "Перегенерировать"
   - Приложение автоматически пробует разные модели

3. **Проверьте длину текста:**
   - Убедитесь, что история содержит не менее 10 символов
   - Убедитесь, что вопрос содержит не менее 5 символов

## Тестирование подключения к AI

Вы можете протестировать подключение к Hugging Face API с помощью встроенного теста:

1. Откройте приложение в браузере
2. Перейдите на страницу "Генератор сценариев"
3. Нажмите кнопку "Тест AI"
4. Дождитесь результата теста

## Получение поддержки

Если вы не можете решить проблему самостоятельно:

1. Проверьте логи в терминале
2. Убедитесь, что все шаги из README выполнены корректно
3. Создайте issue в репозитории с подробным описанием проблемы

## Дополнительные советы

### Для улучшения качества генерации:
1. Используйте подробные и интересные истории
2. Формулируйте вопросы "что если" с конкретикой
3. Попробуйте разные модели, изменив код в `src/lib/ai-service.ts`

### Для диагностики проблем:
1. Проверьте логи сервера в терминале
2. Убедитесь, что API ключ корректен
3. Попробуйте выполнить простой запрос к API вручную